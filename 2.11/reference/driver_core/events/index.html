<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="">
<meta name="author" content="">
<meta name="keyword" content="">

    <link rel="shortcut icon" href="/mongo-csharp-driver/2.11/img/favicon.png">

    <title>Eventing</title>

    <link rel="stylesheet" href="/mongo-csharp-driver/2.11/lib/bootstrap.css" type="text/css" />
<link rel="stylesheet" href="/mongo-csharp-driver/2.11/lib/font-awesome/css/font-awesome.min.css" type="text/css" />
<link rel="stylesheet" href="/mongo-csharp-driver/2.11/css/mongodb-docs.css" type="text/css" />
<link rel="stylesheet" href="/mongo-csharp-driver/2.11/css/overrides.css" type="text/css" />
<link rel="stylesheet" href="/mongo-csharp-driver/2.11/lib/highlight/styles/idea.css" />
<link rel="stylesheet" href="/mongo-csharp-driver/2.11/lib/bootstrap-toggle/bootstrap-toggle.min.css" type="text/css" />
<link rel="stylesheet" href="/mongo-csharp-driver/2.11/css/dn.css" type="text/css" />


  </head>

  <body>
  
  <section id="container" class="">
      
      <header id="header-db" class="row" role="navigation">
  <div class="header-content">
    <div class="toggle-nav pull-left">
        <i class="fa fa-bars"></i>
        <div class="icon-reorder tooltips" data-original-title="Toggle Navigation" data-placement="bottom"></div>
    </div>
    
    <div class="logo pull-left">
      <a href="/mongo-csharp-driver/2.11/../">
        <img src="/mongo-csharp-driver/2.11/img/logo-mongodb-header.png", alt="MongoDB.org" />
      </a>
    </div>
    
    <div>
<div class="nav-items pull-right">
  <a href="https://university.mongodb.com" data-toggle="tooltip" data-placement="bottom" title="Try MongoDB in the browser">Try it Out</a>
  <a href="https://www.mongodb.com/try" data-toggle="tooltip" data-placement="bottom" title="Download MongoDB">Downloads</a>
  <a href="https://www.mongodb.com/community" data-toggle="tooltip" data-placement="bottom" title="Get involved with MongoDB">Community</a>
  <a href="https://www.mongodb.com/docs" data-toggle="tooltip" data-placement="bottom" title="The MongoDB Documentation">Docs</a>
  <a href="https://www.mongodb.com/blog" data-toggle="tooltip" data-placement="bottom" title="The MongoDB Blog">Blog</a>
  <div id="search">
<form method="get" action="//www.google.com/search" target="_blank">
    <input type="text" name="searchQuery" size="20" value="" autocomplete="off" placeholder="Search docs">
    <input type="hidden" name="site" value="/mongo-csharp-driver/2.11">
    <input type="hidden" name="q" value="">
    <label for="searchQuery"><i class="fa fa-search fa-1"></i></label>
</form>
</div>

</div>
</div>

  </div>
</header>

      

      
<aside id="sidebar" class="sidebar">
    <div class="ssidebar nav-collapse">
      <div class="ssidebarwrapper">
        <h3>
          <a class="index-link" href="/mongo-csharp-driver/2.11/../">MongoDB .NET Driver</a>
          <a class="version pull-right" href="/mongo-csharp-driver/2.11">2.11</a>
        </h3>

        
        <ul class="sidebar-menu">
          
          
          
          
          
          
          
          
          
          
          
          

          
          
            
            









  
    
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
    
      
    
  


          
            
            









  
    
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
    
      
    
  


          
            
            









  
    
    
      
      
        
        
        
        
        
        
        
        









  
    
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  
    
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  
    
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
    
      
    
  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  
    
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
    
      
    
  


        
          
        
      
    
    
      
    
  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  
    
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
    
      
    
  


        
          
        
      
    
    
      
    
  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  
    
    
      
      
        
        
        
        
        
        
        
        









  
    
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
    
      
    
  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  
    
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
    
      
    
  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  
    
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
    
      
    
  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
    
      
    
  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  
    
    
      
      
        
        
        
        
        
        
        
        









  
  
  
  
  
  
  
  

  
    
    
    
      
      
      
        
      
    
    
  
  


        
      
    
    
  


        
      
    
      
      
        
      
    
    
  


          
            
            









  
    
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
    
  


          
            
            









  


          
            
            









  


          
            
            









  


          

          

          
            
            
















<li class="toctree-l1 ">
  <a href="/mongo-csharp-driver/2.11/getting_started/" class="">
      <i class='fa fa-road'></i>
      <span>Getting Started</span>
      <span class="menu-arrow fa fa-angle-right"></span>
  </a>
    <ul >
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongo-csharp-driver/2.11/getting_started/installation/">
        <i class='fa'></i>
        Installation
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongo-csharp-driver/2.11/getting_started/quick_tour/">
        <i class='fa'></i>
        Quick Tour
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongo-csharp-driver/2.11/getting_started/admin_quick_tour/">
        <i class='fa'></i>
        Admin Quick Tour
    </a>
  </li>


        
        
    </ul>
  </li>


          
            
            
















<li class="toctree-l1 ">
  <a href="/mongo-csharp-driver/2.11/what_is_new/" class="">
      <i class='fa fa-star'></i>
      <span>What&#39;s New</span>
      <span class="menu-arrow fa fa-angle-right"></span>
  </a>
    <ul >
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongo-csharp-driver/2.11/upgrading/">
        <i class='fa'></i>
        Upgrading
    </a>
  </li>


        
        
    </ul>
  </li>


          
            
            













  




<li class="toctree-l1  current">
  <a href="/mongo-csharp-driver/2.11/reference/" class="">
      <i class='fa fa-book'></i>
      <span>Reference</span>
      <span class="menu-arrow fa fa-angle-down"></span>
  </a>
    <ul  class="current">
        
        
        
        
















<li class="toctree-l2 ">
  <a href="/mongo-csharp-driver/2.11/reference/bson/" class="">
      <i class='fa'></i>
      <span>BSON</span>
      
  </a>
    <ul >
        
        
        
        
















    <li class="toctree-l3">
    <a href="/mongo-csharp-driver/2.11/reference/bson/bson/">
        <i class='fa'></i>
        BSON/JSON
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l3">
    <a href="/mongo-csharp-driver/2.11/reference/bson/bson_document/">
        <i class='fa'></i>
        BsonDocument
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l3">
    <a href="/mongo-csharp-driver/2.11/reference/bson/serialization/">
        <i class='fa'></i>
        Serialization
    </a>
  </li>


        
        
        
        
        
















<li class="toctree-l3 ">
  <a href="/mongo-csharp-driver/2.11/reference/bson/guidserialization/" class="">
      <i class='fa'></i>
      <span>Guid Serialization</span>
      
  </a>
    <ul >
        
        
        
        
















    <li class="toctree-l4">
    <a href="/mongo-csharp-driver/2.11/reference/bson/guidserialization/background/">
        <i class='fa'></i>
        Background
    </a>
  </li>


        
        
        
        
        
















<li class="toctree-l4 ">
  <a href="/mongo-csharp-driver/2.11/reference/bson/guidserialization/guidrepresentationmode/guidrepresentationmode/" class="">
      <i class='fa'></i>
      <span>GuidRepresentationMode</span>
      
  </a>
    <ul >
        
        
        
        
















    <li class="toctree-l5">
    <a href="/mongo-csharp-driver/2.11/reference/bson/guidserialization/guidrepresentationmode/v2mode/">
        <i class='fa'></i>
        V2 mode
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l5">
    <a href="/mongo-csharp-driver/2.11/reference/bson/guidserialization/guidrepresentationmode/v3mode/">
        <i class='fa'></i>
        V3 mode
    </a>
  </li>


        
        
    </ul>
  </li>


        
        
        
        
        
















<li class="toctree-l4 ">
  <a href="/mongo-csharp-driver/2.11/reference/bson/guidserialization/serializerchanges/serializerchanges/" class="">
      <i class='fa'></i>
      <span>Serializer changes</span>
      
  </a>
    <ul >
        
        
        
        
















    <li class="toctree-l5">
    <a href="/mongo-csharp-driver/2.11/reference/bson/guidserialization/serializerchanges/guidserializerchanges/">
        <i class='fa'></i>
        GuidSerializer changes
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l5">
    <a href="/mongo-csharp-driver/2.11/reference/bson/guidserialization/serializerchanges/objectserializerchanges/">
        <i class='fa'></i>
        ObjectSerializer changes
    </a>
  </li>


        
        
    </ul>
  </li>


        
        
    </ul>
  </li>


        
        
        
        
        
















<li class="toctree-l3 ">
  <a href="/mongo-csharp-driver/2.11/reference/bson/mapping/" class="">
      <i class='fa'></i>
      <span>Mapping Classes</span>
      
  </a>
    <ul >
        
        
        
        
















    <li class="toctree-l4">
    <a href="/mongo-csharp-driver/2.11/reference/bson/mapping/polymorphism/">
        <i class='fa'></i>
        Polymorphism
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l4">
    <a href="/mongo-csharp-driver/2.11/reference/bson/mapping/conventions/">
        <i class='fa'></i>
        Conventions
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l4">
    <a href="/mongo-csharp-driver/2.11/reference/bson/mapping/schema_changes/">
        <i class='fa'></i>
        Handling Schema Changes
    </a>
  </li>


        
        
    </ul>
  </li>


        
        
    </ul>
  </li>


        
        
        
        
        
















<li class="toctree-l2 ">
  <a href="/mongo-csharp-driver/2.11/reference/driver/" class="">
      <i class='fa'></i>
      <span>Driver</span>
      
  </a>
    <ul >
        
        
        
        
















<li class="toctree-l3 ">
  <a href="/mongo-csharp-driver/2.11/reference/driver/connecting/" class="">
      <i class='fa'></i>
      <span>Connecting</span>
      
  </a>
    <ul >
        
        
        
        
















    <li class="toctree-l4">
    <a href="/mongo-csharp-driver/2.11/reference/driver/ssl/">
        <i class='fa'></i>
        SSL
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l4">
    <a href="/mongo-csharp-driver/2.11/reference/driver/authentication/">
        <i class='fa'></i>
        Authentication
    </a>
  </li>


        
        
    </ul>
  </li>


        
        
        
        
        
















<li class="toctree-l3 ">
  <a href="/mongo-csharp-driver/2.11/reference/driver/definitions/" class="">
      <i class='fa'></i>
      <span>Definitions and Builders</span>
      
  </a>
    <ul >
        
        
        
        
















    <li class="toctree-l4">
    <a href="/mongo-csharp-driver/2.11/reference/driver/expressions/">
        <i class='fa'></i>
        Expressions
    </a>
  </li>


        
        
    </ul>
  </li>


        
        
        
        
        
















    <li class="toctree-l3">
    <a href="/mongo-csharp-driver/2.11/reference/driver/admin/">
        <i class='fa'></i>
        Administration
    </a>
  </li>


        
        
        
        
        
















<li class="toctree-l3 ">
  <a href="/mongo-csharp-driver/2.11/reference/driver/crud/" class="">
      <i class='fa'></i>
      <span>Reading and Writing</span>
      
  </a>
    <ul >
        
        
        
        
















    <li class="toctree-l4">
    <a href="/mongo-csharp-driver/2.11/reference/driver/crud/reading/">
        <i class='fa'></i>
        Reading
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l4">
    <a href="/mongo-csharp-driver/2.11/reference/driver/crud/linq/">
        <i class='fa'></i>
        LINQ
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l4">
    <a href="/mongo-csharp-driver/2.11/reference/driver/crud/writing/">
        <i class='fa'></i>
        Writing
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l4">
    <a href="/mongo-csharp-driver/2.11/reference/driver/crud/compression/">
        <i class='fa'></i>
        Compression
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l4">
    <a href="/mongo-csharp-driver/2.11/reference/driver/crud/sessions_and_transactions/">
        <i class='fa'></i>
        Sessions and Transactions
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l4">
    <a href="/mongo-csharp-driver/2.11/reference/driver/crud/client_side_encryption/">
        <i class='fa fa-lock'></i>
        Client-Side Encryption
    </a>
  </li>


        
        
    </ul>
  </li>


        
        
        
        
        
















    <li class="toctree-l3">
    <a href="/mongo-csharp-driver/2.11/reference/driver/change_streams/">
        <i class='fa'></i>
        Change Streams
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l3">
    <a href="/mongo-csharp-driver/2.11/reference/driver/error_handling/">
        <i class='fa'></i>
        Error Handling
    </a>
  </li>


        
        
    </ul>
  </li>


        
        
        
        
        













  




<li class="toctree-l2  current">
  <a href="/mongo-csharp-driver/2.11/reference/driver_core/" class="">
      <i class='fa'></i>
      <span>Driver Core</span>
      
  </a>
    <ul  class="current">
        
        
        
        













  




<li class="toctree-l3  current">
  <a href="/mongo-csharp-driver/2.11/reference/driver_core/events/" class="">
      <i class='fa'></i>
      <span>Eventing</span>
      
  </a>
    <ul  class="current">
        
        
        
        
















    <li class="toctree-l4">
    <a href="/mongo-csharp-driver/2.11/reference/driver_core/sdamevents/">
        <i class='fa'></i>
        SDAM Events
    </a>
  </li>


        
        
    </ul>
  </li>


        
        
    </ul>
  </li>


        
        
        
        
        
















<li class="toctree-l2 ">
  <a href="/mongo-csharp-driver/2.11/reference/gridfs/" class="">
      <i class='fa'></i>
      <span>GridFS</span>
      
  </a>
    <ul >
        
        
        
        
















    <li class="toctree-l3">
    <a href="/mongo-csharp-driver/2.11/reference/gridfs/gettingstarted/">
        <i class='fa'></i>
        Getting Started
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l3">
    <a href="/mongo-csharp-driver/2.11/reference/gridfs/uploadingfiles/">
        <i class='fa'></i>
        Uploading Files
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l3">
    <a href="/mongo-csharp-driver/2.11/reference/gridfs/downloadingfiles/">
        <i class='fa'></i>
        Downloading Files
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l3">
    <a href="/mongo-csharp-driver/2.11/reference/gridfs/findingfiles/">
        <i class='fa'></i>
        Finding Files
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l3">
    <a href="/mongo-csharp-driver/2.11/reference/gridfs/deletingandrenamingfiles/">
        <i class='fa'></i>
        Deleting and Renaming Files
    </a>
  </li>


        
        
    </ul>
  </li>


        
        
    </ul>
  </li>


          
            
            
















<li class="toctree-l1 ">
  <a href="/mongo-csharp-driver/2.11/examples/" class="">
      <i class='fa fa-code'></i>
      <span>Examples</span>
      <span class="menu-arrow fa fa-angle-right"></span>
  </a>
    <ul >
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongo-csharp-driver/2.11/examples/exporting_json/">
        <i class='fa'></i>
        Exporting JSON
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongo-csharp-driver/2.11/examples/importing_json/">
        <i class='fa'></i>
        Importing JSON
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongo-csharp-driver/2.11/examples/mixing_static_and_dynamic/">
        <i class='fa'></i>
        Mixing Static and Dynamic Data
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongo-csharp-driver/2.11/examples/tailable_cursor/">
        <i class='fa'></i>
        Using a Tailable Cursor
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongo-csharp-driver/2.11/examples/user_management/">
        <i class='fa'></i>
        Managing Users
    </a>
  </li>


        
        
    </ul>
  </li>


          
            
            
















    <li class="toctree-l1">
    <a href="/mongo-csharp-driver/2.11/apidocs/">
        <i class='fa fa-file-text-o'></i>
        API Documentation
    </a>
  </li>


          
            
            
















    <li class="toctree-l1">
    <a href="https://github.com/mongodb/mongo-csharp-driver/tree/master">
        <i class='fa fa-github'></i>
        Source Code
    </a>
  </li>


          
            
            
















    <li class="toctree-l1">
    <a href="/mongo-csharp-driver/2.11/issues_help/">
        <i class='fa fa-life-ring'></i>
        Issues &amp; Help
    </a>
  </li>


          
        </ul>
        
    </div>
  </div>
  
</aside>

<div class="option-popup closed hidden" id="optionsVersionsPopup">
<div class="option-header">
  <i class="fa fa-gear"></i>
  <span>OPTIONS</span>
  <i class="fa fa-angle-up pull-right"></i>
</div>
<div class="option-body">
  <ul>
      
      <li>
        <label>Version</label>
        <div class="btn-group btn-group-xs pull-right">
          <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
            Select Version <span class="caret"></span>
          </button>
          <ul class="dropdown-menu" role="menu" id="optionsVersionsMenu">
          </ul>
        </div>
      </li>

   


    

  </ul>
</div>
</div>



      
      <section id="main-content" class="content">
          <section class="main-column pull-left">
            <div class="document">
              <div class="documentwrapper">
                <div class="bodywrapper">
                  <div class="body">


   
<a class="edit-link" href="https://github.com/mongodb/mongo-csharp-driver/blob/master/docs/reference/content/reference%5cdriver_core%5cevents.md" target="_blank" title="Edit reference\driver_core\events.md on GitHub"><i class="fa fa-pencil-square-o"></i></a>










<div class="bc">
<ul>
  
  
  
  
  <li><a href="/mongo-csharp-driver/2.11/reference/">Reference</a> <i class="fa fa-angle-right"></i></li>
  <li><a href="/mongo-csharp-driver/2.11/reference/driver_core/">Driver Core</a> <i class="fa fa-angle-right"></i></li>
  <li>Eventing</li>
</ul>
</div>




<h2 id="eventing">Eventing</h2>

<p>The .NET Driver core provides a robust model for event publication and subscription. Each event is represented by a class or struct which contains all the information related to the particular event.</p>

<h3 id="clusterbuilder">ClusterBuilder</h3>

<p>The <a href="/mongo-csharp-driver/2.11/apidocs/html/T_MongoDB_Driver_Core_Configuration_ClusterBuilder.htm
"><code>ClusterBuilder</code></a> class contains two methods for subscribing to events.</p>

<h4 id="ieventsubscriber">IEventSubscriber</h4>

<p>The first version of <a href="/mongo-csharp-driver/2.11/apidocs/html/M_MongoDB_Driver_Core_Configuration_ClusterBuilder_Subscribe.htm
"><code>Subscribe</code></a> takes an <a href="/mongo-csharp-driver/2.11/apidocs/html/T_MongoDB_Driver_Core_Events_IEventSubscriber.htm
"><code>IEventSubscriber</code></a>. <a href="/mongo-csharp-driver/2.11/apidocs/html/T_MongoDB_Driver_Core_Events_IEventSubscriber.htm
"><code>IEventSubscriber</code></a> contains a single method to implement, <a href="/mongo-csharp-driver/2.11/apidocs/html/M_MongoDB_Driver_Core_Events_IEventSubscriber_TryGetEventHandler_1.htm
"><code>TryGetEventHandler</code></a>. It takes a generic parameter indicating the type of event and sets an out parameter with the handler.</p>

<p><div class="admonition note">
<h5 class="admonition-title">Note</h5>
This method will be invoked once on each subscriber per event type. Therefore, performance of this method is not critical.
</div>
</p>

<p>For instance, to handle the <a href="/mongo-csharp-driver/2.11/apidocs/html/T_MongoDB_Driver_Core_Events_ConnectionPoolAddedConnectionEvent.htm
"><code>ConnectionPoolAddedConnectionEvent</code></a>, the following could be done:</p>

<pre><code class="language-csharp">public class MyEventSubscriber : IEventSubscriber
{
    public bool TryGetEventHandler&lt;TEvent&gt;(out Action&lt;TEvent&gt; handler)
    {
        if(typeof(TEvent)) == typeof(ConnectionPoolAddedConnectionEvent))
        {
            handler = (Action&lt;TEvent&gt;)HandleConnectionPoolAddedConnectionEvent;
            return true;
        }

        handler = null;
        return false;
    }

    private void HandleConnectionPoolAddedConnectionEvent(ConnectionPoolAddedConnectionEvent @event)
    {
        Console.WriteLine(&quot;Added a connection to the pool.&quot;);
    }
}
</code></pre>

<p>This could quickly become unmaintainable with multiple events. To make this easier, we have implemented the <a href="/mongo-csharp-driver/2.11/apidocs/html/T_MongoDB_Driver_Core_Events_ReflectionEventSubscriber.htm
"><code>ReflectionEventSubscriber</code></a>. It uses reflection to find all the event handler methods inside a class based on certain constructor parameters for the method name and the binding flags. For instance, we could change the above <code>MyEventSubscriber</code> class as follows:</p>

<pre><code class="language-csharp">public class MyEventSubscriber : IEventSubscriber
{
    private readonly IEventSubscriber _subscriber;

    public MyEventSubscriber()
    {
        _subscriber = new ReflectionEventSubscriber(this);
    }

    public bool TryGetEventHandler&lt;TEvent&gt;(out Action&lt;TEvent&gt; handler)
    {
        return _subscriber.TryGetEventHandler(out handler);
    }

    private void Handle(ConnectionPoolAddedConnectionEvent @event)
    {
        Console.WriteLine(&quot;Added a connection to the pool.&quot;);
    }

    private void Handle(ConnectionPoolRemovedConnectionEvent @event)
    {
        Console.WriteLine(&quot;Removed a connection from the pool.&quot;);
    }
}
</code></pre>

<p><div class="admonition note">
<h5 class="admonition-title">Note</h5>
The default method name is &ldquo;Handle&rdquo; and the default binding flags are for public instance methods.
</div>
</p>

<p>The <a href="https://github.com/mongodb/mongo-csharp-driver/blob/master/src/MongoDB.Driver.Core/Core/Events/Diagnostics/PerformanceCounterEventSubscriber.cs
"><code>PerformanceCounterEventSubscriber</code></a> is a good example of utilizing the <a href="/mongo-csharp-driver/2.11/apidocs/html/T_MongoDB_Driver_Core_Events_ReflectionEventSubscriber.htm
"><code>ReflectionEventSubscriber</code></a>.</p>

<h4 id="method">Method</h4>

<p>The second version of <a href="/mongo-csharp-driver/2.11/apidocs/html/M_MongoDB_Driver_Core_Configuration_ClusterBuilder_Subscribe.htm
"><code>Subscribe</code></a> takes an <a href="https://msdn.microsoft.com/en-us/library/018hxwa8.aspx"><code>Action&lt;TEvent&gt;</code></a>. For example, to use a static method:</p>

<pre><code class="language-csharp">static void Main() 
{
    var builder = new ClusterBuilder();

    builder.Subscribe&lt;ConnectionPoolAddedConnectionEvent&gt;(Handle);

    // ... snip
}

private static void Handle(ConnectionPoolAddedConnectionEvent @event)
{
    Console.WriteLine(&quot;Added a connection to the pool.&quot;);
}
</code></pre>

<p>Alternatively, a lambda expression could be used:</p>

<pre><code class="language-csharp">static void Main() 
{
    var builder = new ClusterBuilder();

    builder.Subscribe&lt;ConnectionPoolAddedConnectionEvent&gt;(x =&gt; Console.WriteLine(&quot;Added a connection to the pool.&quot;));

    // ... snip
}
</code></pre>

<h3 id="operation-ids">Operation Ids</h3>

<p>Any commands that could occur based on user initiation will contain an operation identifier. This identifer can be used to link together all events that occured due to the user initiated action.</p>

<h3 id="clusterid-serverid-and-connectionid">ClusterId, ServerId, and ConnectionId</h3>

<p>All events will contain at least one of these identifiers. They can be used to uniquely attribute a particular event to a cluster, a server, or a connection. In addition, the ConnectionId also contains a local value and a server value where the server value contains the same value that will show up in the server logs for its connection logging.</p>

<h3 id="command-events">Command Events</h3>

<p>There are three events related to monitoring data sent on the wire. These are the <a href="/mongo-csharp-driver/2.11/apidocs/html/T_MongoDB_Driver_Core_Events_CommandStartedEvent.htm
"><code>CommandStartedEvent</code></a>, the <a href="/mongo-csharp-driver/2.11/apidocs/html/T_MongoDB_Driver_Core_Events_CommandSucceededEvent.htm
"><code>CommandSucceededEvent</code></a>, and the <a href="/mongo-csharp-driver/2.11/apidocs/html/T_MongoDB_Driver_Core_Events_CommandFailedEvent.htm
"><code>CommandFailedEvent</code></a>. For every started event, there will always be a succeeded or failed event.</p>

<p>In addition, any messages sent to the server that are not already commands will be upconverted for the sake of consumption. For instance, an <code>OP_DELETE</code> wire protocol message on server 2.4 will appear as though it were a <a href="https://www.mongodb.com/docs/manual/reference/command/delete/
"><code>delete</code></a> command.</p>

<p><div class="admonition warning">
<h5 class="admonition-title">warning</h5>
These are heavy events to generate. Do not subscribe to these unless they provide necessary information.
</div>
</p>

<p><div class="admonition note">
<h5 class="admonition-title">Note</h5>
<p>Certain information has been removed for security reasons. For instance, the <a href="https://www.mongodb.com/docs/manual/reference/command/authenticate/"><code>authenticate</code></a> command will not contain the actual command or its reply. However, it will still contain the command name itself.</p>

</div>
</p>

<h4 id="commandstartedevent">CommandStartedEvent</h4>

<p>The <a href="/mongo-csharp-driver/2.11/apidocs/html/T_MongoDB_Driver_Core_Events_CommandStartedEvent.htm
"><code>CommandStartedEvent</code></a> contains, amongst other information, the command name as well as the command itself. While the command also contains the command name, the command is potentially heavy to access and will not live beyond the lifetime of the event. Any information necessary from the command should be pulled out and used immediately or stored.</p>

<h4 id="commandsucceededevent">CommandSucceededEvent</h4>

<p>The <a href="/mongo-csharp-driver/2.11/apidocs/html/T_MongoDB_Driver_Core_Events_CommandSucceededEvent.htm
"><code>CommandSucceededEvent</code></a> contains, amongst other information, the command name, the duration of the command, and the reply. The reply is potentially heavy to access and will not live beyond the lifetime of the event.  Any information necessary from the reply should be pulled out and used immediately or stored.</p>

<h4 id="commandfailedevent">CommandFailedEvent</h4>

<p>The <a href="/mongo-csharp-driver/2.11/apidocs/html/T_MongoDB_Driver_Core_Events_CommandFailedEvent.htm
"><code>CommandFailedEvent</code></a> contains, amongst other information, the command name, the duration of the command, and the exception. The exception is potentially heavy to access and will not live beyond the lifetime of the event.  Any information necessary from the exception should be pulled out and used immediately or stored.</p>

<h3 id="sdam-events">SDAM Events</h3>

<p>There are a number of events that are raised as part of Server Discovery and Monitoring (SDAM). See <a href="/mongo-csharp-driver/2.11/reference/driver_core/sdamevents/">SDAM Events</a> for more information.</p>






<div id="btnv">
  
  <div class="pull-left">
  <a class="navigation prev" href="/mongo-csharp-driver/2.11/reference/driver/">
      <i class="fa fa-long-arrow-left"> </i> Driver
  </a>
  </div>
  
  
  <div class="pull-right">
  <a class="navigation next" href="/mongo-csharp-driver/2.11/reference/gridfs/">
    GridFS <i class="fa fa-long-arrow-right"> </i>
  </a>
  
</div>
</div>


</div>
<div class="right-column">
<div class="wrapper">
  
  <div class="toc">
    <span class="toc-header">On this page</span>
    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#eventing">Eventing</a>
<ul>
<li><a href="#clusterbuilder">ClusterBuilder</a>
<ul>
<li><a href="#ieventsubscriber">IEventSubscriber</a></li>
<li><a href="#method">Method</a></li>
</ul></li>
<li><a href="#operation-ids">Operation Ids</a></li>
<li><a href="#clusterid-serverid-and-connectionid">ClusterId, ServerId, and ConnectionId</a></li>
<li><a href="#command-events">Command Events</a>
<ul>
<li><a href="#commandstartedevent">CommandStartedEvent</a></li>
<li><a href="#commandsucceededevent">CommandSucceededEvent</a></li>
<li><a href="#commandfailedevent">CommandFailedEvent</a></li>
</ul></li>
<li><a href="#sdam-events">SDAM Events</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
  </div>
  
</div>
</div>

</div>
</div>
</div>
</section>
</section>

</section>


<script type="text/javascript">
  var DOCUMENTATION_OPTIONS = {
   URL_ROOT:    "/mongo-csharp-driver/2.11",
   VERSION:     "2.11",
   COLLAPSE_INDEX: false,
   FILE_SUFFIX: '.html',
   HAS_SOURCE:  true
  };
</script>
<script type="text/javascript" src="/mongo-csharp-driver/2.11/js/jquery.js"></script>
<script type="text/javascript" src="/mongo-csharp-driver/2.11/lib/bootstrap.js"></script>
<script type="text/javascript" src="/mongo-csharp-driver/2.11/js/navbar.js"></script>
<script type="text/javascript" src="/mongo-csharp-driver/2.11/lib/highlight/highlight.pack.js"></script>
<script type="text/javascript" src="/mongo-csharp-driver/2.11/js/scripts.js"></script>
<script type="text/javascript" src="/mongo-csharp-driver/2.11/lib/bootstrap-toggle/bootstrap-toggle.min.js"></script>
<script type="text/javascript" src="/mongo-csharp-driver/2.11/lib/delighted.js"></script>
<script type="text/javascript" src="/mongo-csharp-driver/2.11/js/dn.js"></script>


<noscript><iframe src="//www.googletagmanager.com/ns.html?id=UA-7301842-14"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push(
{'gtm.start': new Date().getTime(),event:'gtm.js'}
);var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','UA-7301842-14');</script>


<script type="text/javascript">
var _elqQ = _elqQ || [];
_elqQ.push(['elqSetSiteId', '413370795']);
_elqQ.push(['elqTrackPageView']);
(function () {
function async_load()
{ var s = document.createElement('script'); s.type = 'text/javascript'; s.async = true; s.src = '//img03.en25.com/i/elqCfg.min.js'; var x = document.getElementsByTagName('script')[0]; x.parentNode.insertBefore(s, x); }
if (window.addEventListener) window.addEventListener('DOMContentLoaded', async_load, false);
else if (window.attachEvent) window.attachEvent('onload', async_load);
})();
</script>

</body>
</html>

