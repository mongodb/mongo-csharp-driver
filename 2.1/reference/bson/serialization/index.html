<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="">
<meta name="author" content="">
<meta name="keyword" content="">

    <link rel="shortcut icon" href="/mongo-csharp-driver/2.1/img/favicon.png">

    <title>Serialization</title>

    <link rel="stylesheet" href="/mongo-csharp-driver/2.1/lib/bootstrap.css" type="text/css" />
<link rel="stylesheet" href="/mongo-csharp-driver/2.1/lib/font-awesome/css/font-awesome.min.css" type="text/css" />
<link rel="stylesheet" href="/mongo-csharp-driver/2.1/css/mongodb-docs.css" type="text/css" />
<link rel="stylesheet" href="/mongo-csharp-driver/2.1/css/overrides.css" type="text/css" />
<link rel="stylesheet" href="/mongo-csharp-driver/2.1/lib/highlight/styles/idea.css" />
<link rel="stylesheet" href="/mongo-csharp-driver/2.1/lib/bootstrap-toggle/bootstrap-toggle.min.css" type="text/css" />
<link rel="stylesheet" href="/mongo-csharp-driver/2.1/css/dn.css" type="text/css" />


  </head>

  <body>
  
  <section id="container" class="">
      
      <header id="header-db" class="row" role="navigation">
  <div class="header-content">
    <div class="toggle-nav pull-left">
        <i class="fa fa-bars"></i>
        <div class="icon-reorder tooltips" data-original-title="Toggle Navigation" data-placement="bottom"></div>
    </div>
    
    <div class="logo pull-left">
      <a href="/mongo-csharp-driver/2.1/../">
        <img src="/mongo-csharp-driver/2.1/img/logo-mongodb-header.png", alt="MongoDB.org" />
      </a>
    </div>
    
    <div>
<div class="nav-items pull-right">
  <a href="https://university.mongodb.com" data-toggle="tooltip" data-placement="bottom" title="Try MongoDB in the browser">Try it Out</a>
  <a href="https://www.mongodb.com/try" data-toggle="tooltip" data-placement="bottom" title="Download MongoDB">Downloads</a>
  <a href="https://www.mongodb.com/community" data-toggle="tooltip" data-placement="bottom" title="Get involved with MongoDB">Community</a>
  <a href="https://www.mongodb.com/docs" data-toggle="tooltip" data-placement="bottom" title="The MongoDB Documentation">Docs</a>
  <a href="https://www.mongodb.com/blog" data-toggle="tooltip" data-placement="bottom" title="The MongoDB Blog">Blog</a>
  <div id="search">
<form method="get" action="//www.google.com/search" target="_blank">
    <input type="text" name="searchQuery" size="20" value="" autocomplete="off" placeholder="Search docs">
    <input type="hidden" name="site" value="/mongo-csharp-driver/2.1">
    <input type="hidden" name="q" value="">
    <label for="searchQuery"><i class="fa fa-search fa-1"></i></label>
</form>
</div>

</div>
</div>

  </div>
</header>

      

      
<aside id="sidebar" class="sidebar">
    <div class="ssidebar nav-collapse">
      <div class="ssidebarwrapper">
        <h3>
          <a class="index-link" href="/mongo-csharp-driver/2.1/../">MongoDB .NET Driver</a>
          <a class="version pull-right" href="/mongo-csharp-driver/2.1">2.1</a>
        </h3>

        
        <ul class="sidebar-menu">
          
          
          
          
          
          
          
          
          
          
          
          

          
          
            
            









  
    
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
    
      
    
  


          
            
            









  
    
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
    
      
    
  


          
            
            









  
    
    
      
      
        
        
        
        
        
        
        
        









  
    
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  
  
  
  
  
  
  
  

  
    
    
    
      
      
      
        
      
    
    
  
  


        
      
    
      
      
        
      
    
    
  


        
      
    
      
      
    
      
      
    
      
      
    
    
  


          
            
            









  
    
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
    
  


          
            
            









  


          
            
            









  


          
            
            









  


          

          

          
            
            
















<li class="toctree-l1 ">
  <a href="/mongo-csharp-driver/2.1/getting_started/" class="">
      <i class='fa fa-road'></i>
      <span>Getting Started</span>
      <span class="menu-arrow fa fa-angle-right"></span>
  </a>
    <ul >
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongo-csharp-driver/2.1/getting_started/installation/">
        <i class='fa'></i>
        Installation
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongo-csharp-driver/2.1/getting_started/quick_tour/">
        <i class='fa'></i>
        Quick Tour
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongo-csharp-driver/2.1/getting_started/admin_quick_tour/">
        <i class='fa'></i>
        Admin Quick Tour
    </a>
  </li>


        
        
    </ul>
  </li>


          
            
            
















<li class="toctree-l1 ">
  <a href="/mongo-csharp-driver/2.1/what_is_new/" class="">
      <i class='fa fa-star'></i>
      <span>What&#39;s New</span>
      <span class="menu-arrow fa fa-angle-right"></span>
  </a>
    <ul >
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongo-csharp-driver/2.1/upgrading/">
        <i class='fa'></i>
        Upgrading
    </a>
  </li>


        
        
    </ul>
  </li>


          
            
            













  




<li class="toctree-l1  current">
  <a href="/mongo-csharp-driver/2.1/reference/" class="">
      <i class='fa fa-book'></i>
      <span>Reference</span>
      <span class="menu-arrow fa fa-angle-down"></span>
  </a>
    <ul  class="current">
        
        
        
        













  




<li class="toctree-l2  current">
  <a href="/mongo-csharp-driver/2.1/reference/bson/" class="">
      <i class='fa'></i>
      <span>BSON</span>
      
  </a>
    <ul  class="current">
        
        
        
        
















    <li class="toctree-l3">
    <a href="/mongo-csharp-driver/2.1/reference/bson/bson/">
        <i class='fa'></i>
        BSON/JSON
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l3">
    <a href="/mongo-csharp-driver/2.1/reference/bson/bson_document/">
        <i class='fa'></i>
        BsonDocument
    </a>
  </li>


        
        
        
        
        













  




    <li class="toctree-l3">
    <a href="/mongo-csharp-driver/2.1/reference/bson/serialization/">
        <i class='fa'></i>
        Serialization
    </a>
  </li>


        
        
        
        
        
















<li class="toctree-l3 ">
  <a href="/mongo-csharp-driver/2.1/reference/bson/mapping/" class="">
      <i class='fa'></i>
      <span>Mapping Classes</span>
      
  </a>
    <ul >
        
        
        
        
















    <li class="toctree-l4">
    <a href="/mongo-csharp-driver/2.1/reference/bson/mapping/polymorphism/">
        <i class='fa'></i>
        Polymorphism
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l4">
    <a href="/mongo-csharp-driver/2.1/reference/bson/mapping/conventions/">
        <i class='fa'></i>
        Conventions
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l4">
    <a href="/mongo-csharp-driver/2.1/reference/bson/mapping/schema_changes/">
        <i class='fa'></i>
        Handling Schema Changes
    </a>
  </li>


        
        
    </ul>
  </li>


        
        
    </ul>
  </li>


        
        
        
        
        
















<li class="toctree-l2 ">
  <a href="/mongo-csharp-driver/2.1/reference/driver/" class="">
      <i class='fa'></i>
      <span>Driver</span>
      
  </a>
    <ul >
        
        
        
        
















<li class="toctree-l3 ">
  <a href="/mongo-csharp-driver/2.1/reference/driver/connecting/" class="">
      <i class='fa'></i>
      <span>Connecting</span>
      
  </a>
    <ul >
        
        
        
        
















    <li class="toctree-l4">
    <a href="/mongo-csharp-driver/2.1/reference/driver/ssl/">
        <i class='fa'></i>
        SSL
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l4">
    <a href="/mongo-csharp-driver/2.1/reference/driver/authentication/">
        <i class='fa'></i>
        Authentication
    </a>
  </li>


        
        
    </ul>
  </li>


        
        
        
        
        
















<li class="toctree-l3 ">
  <a href="/mongo-csharp-driver/2.1/reference/driver/definitions/" class="">
      <i class='fa'></i>
      <span>Definitions and Builders</span>
      
  </a>
    <ul >
        
        
        
        
















    <li class="toctree-l4">
    <a href="/mongo-csharp-driver/2.1/reference/driver/expressions/">
        <i class='fa'></i>
        Expressions
    </a>
  </li>


        
        
    </ul>
  </li>


        
        
        
        
        
















    <li class="toctree-l3">
    <a href="/mongo-csharp-driver/2.1/reference/driver/admin/">
        <i class='fa'></i>
        Administration
    </a>
  </li>


        
        
        
        
        
















<li class="toctree-l3 ">
  <a href="/mongo-csharp-driver/2.1/reference/driver/crud/" class="">
      <i class='fa'></i>
      <span>Reading and Writing</span>
      
  </a>
    <ul >
        
        
        
        
















    <li class="toctree-l4">
    <a href="/mongo-csharp-driver/2.1/reference/driver/crud/reading/">
        <i class='fa'></i>
        Reading
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l4">
    <a href="/mongo-csharp-driver/2.1/reference/driver/crud/linq/">
        <i class='fa'></i>
        LINQ
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l4">
    <a href="/mongo-csharp-driver/2.1/reference/driver/crud/writing/">
        <i class='fa'></i>
        Writing
    </a>
  </li>


        
        
    </ul>
  </li>


        
        
        
        
        
















    <li class="toctree-l3">
    <a href="/mongo-csharp-driver/2.1/reference/driver/error_handling/">
        <i class='fa'></i>
        Error Handling
    </a>
  </li>


        
        
    </ul>
  </li>


        
        
        
        
        
















<li class="toctree-l2 ">
  <a href="/mongo-csharp-driver/2.1/reference/driver_core/" class="">
      <i class='fa'></i>
      <span>Driver Core</span>
      
  </a>
    <ul >
        
        
        
        
















    <li class="toctree-l3">
    <a href="/mongo-csharp-driver/2.1/reference/driver_core/events/">
        <i class='fa'></i>
        Eventing
    </a>
  </li>


        
        
    </ul>
  </li>


        
        
        
        
        
















<li class="toctree-l2 ">
  <a href="/mongo-csharp-driver/2.1/reference/gridfs/" class="">
      <i class='fa'></i>
      <span>GridFS</span>
      
  </a>
    <ul >
        
        
        
        
















    <li class="toctree-l3">
    <a href="/mongo-csharp-driver/2.1/reference/gridfs/gettingstarted/">
        <i class='fa'></i>
        Getting Started
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l3">
    <a href="/mongo-csharp-driver/2.1/reference/gridfs/uploadingfiles/">
        <i class='fa'></i>
        Uploading Files
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l3">
    <a href="/mongo-csharp-driver/2.1/reference/gridfs/downloadingfiles/">
        <i class='fa'></i>
        Downloading Files
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l3">
    <a href="/mongo-csharp-driver/2.1/reference/gridfs/findingfiles/">
        <i class='fa'></i>
        Finding Files
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l3">
    <a href="/mongo-csharp-driver/2.1/reference/gridfs/deletingandrenamingfiles/">
        <i class='fa'></i>
        Deleting and Renaming Files
    </a>
  </li>


        
        
    </ul>
  </li>


        
        
    </ul>
  </li>


          
            
            
















<li class="toctree-l1 ">
  <a href="/mongo-csharp-driver/2.1/examples/" class="">
      <i class='fa fa-code'></i>
      <span>Examples</span>
      <span class="menu-arrow fa fa-angle-right"></span>
  </a>
    <ul >
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongo-csharp-driver/2.1/examples/exporting_json/">
        <i class='fa'></i>
        Exporting JSON
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongo-csharp-driver/2.1/examples/importing_json/">
        <i class='fa'></i>
        Importing JSON
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongo-csharp-driver/2.1/examples/mixing_static_and_dynamic/">
        <i class='fa'></i>
        Mixing Static and Dynamic Data
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongo-csharp-driver/2.1/examples/tailable_cursor/">
        <i class='fa'></i>
        Using a Tailable Cursor
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongo-csharp-driver/2.1/examples/user_management/">
        <i class='fa'></i>
        Managing Users
    </a>
  </li>


        
        
    </ul>
  </li>


          
            
            
















    <li class="toctree-l1">
    <a href="/mongo-csharp-driver/2.1/apidocs">
        <i class='fa fa-file-text-o'></i>
        API Documentation
    </a>
  </li>


          
            
            
















    <li class="toctree-l1">
    <a href="https://github.com/mongodb/mongo-csharp-driver/tree/master">
        <i class='fa fa-github'></i>
        Source Code
    </a>
  </li>


          
            
            
















    <li class="toctree-l1">
    <a href="/mongo-csharp-driver/2.1/issues_help/">
        <i class='fa fa-life-ring'></i>
        Issues &amp; Help
    </a>
  </li>


          
        </ul>
        
    </div>
  </div>
  
</aside>

<div class="option-popup closed hidden" id="optionsVersionsPopup">
<div class="option-header">
  <i class="fa fa-gear"></i>
  <span>OPTIONS</span>
  <i class="fa fa-angle-up pull-right"></i>
</div>
<div class="option-body">
  <ul>
      
      <li>
        <label>Version</label>
        <div class="btn-group btn-group-xs pull-right">
          <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
            Select Version <span class="caret"></span>
          </button>
          <ul class="dropdown-menu" role="menu" id="optionsVersionsMenu">
          </ul>
        </div>
      </li>

   


    

  </ul>
</div>
</div>



      
      <section id="main-content" class="content">
          <section class="main-column pull-left">
            <div class="document">
              <div class="documentwrapper">
                <div class="bodywrapper">
                  <div class="body">


   
<a class="edit-link" href="https://github.com/mongodb/mongo-csharp-driver/blob/master/docs/reference/content/reference%5cbson%5cserialization.md" target="_blank" title="Edit reference\bson\serialization.md on GitHub"><i class="fa fa-pencil-square-o"></i></a>










<div class="bc">
<ul>
  
  
  
  
  <li><a href="/mongo-csharp-driver/2.1/reference/">Reference</a> <i class="fa fa-angle-right"></i></li>
  <li><a href="/mongo-csharp-driver/2.1/reference/bson/">BSON</a> <i class="fa fa-angle-right"></i></li>
  <li>Serialization</li>
</ul>
</div>




<h2 id="serialization">Serialization</h2>

<p><a href="/mongo-csharp-driver/2.1/reference/bson/bson/">Reading and Writing BSON/JSON</a> demonstrates how to manually read and write BSON and JSON. However, using the serialization classes make this process much easier.</p>

<p>Serialization is the process of mapping an object to and from a BSON document. The architecture is extensible with numerous hooks to allow you to take more control of the process when necessary.</p>

<h2 id="serializer-registry">Serializer Registry</h2>

<p>The serializer registry contains all the <a href="/mongo-csharp-driver/2.1/apidocs/html/T_MongoDB_Bson_Serialization_IBsonSerializer.htm
"><code>IBsonSerializers</code></a> that have been registered. It can be accessed via the <a href="/mongo-csharp-driver/2.1/apidocs/html/P_MongoDB_Bson_Serialization_BsonSerializer_SerializerRegistry.htm
"><code>SerializerRegistry</code></a> property of the static class <a href="/mongo-csharp-driver/2.1/apidocs/html/T_MongoDB_Bson_Serialization_BsonSerializer.htm
"><code>BsonSerializer</code></a>.</p>

<p><div class="admonition note">
<h5 class="admonition-title">Note</h5>
This is a global registry. Currently, you cannot use multiple registries in a single application.
</div>
</p>

<h2 id="serialization-provider">Serialization Provider</h2>

<p>The <a href="#serializer-registry">serializer registry</a> is powered by a list of <a href="/mongo-csharp-driver/2.1/apidocs/html/T_MongoDB_Bson_Serialization_IBsonSerializationProvider.htm
"><code>IBsonSerializationProvider</code></a>. A serialization provider allows you to provide serializers on demand. The provider should be registered as soon as possible to ensure that the serializers provided are used. You can delegate handling of any types your custom provider isn&rsquo;t prepared to handle by returning null from <a href="/mongo-csharp-driver/2.1/apidocs/html/M_MongoDB_Bson_Serialization_IBsonSerializationProvider_GetSerializer.htm
"><code>GetSerializer</code></a>.</p>

<h3 id="implementation">Implementation</h3>

<p>To implement an <a href="/mongo-csharp-driver/2.1/apidocs/html/T_MongoDB_Bson_Serialization_IBsonSerializationProvider.htm
"><code>IBsonSerializationProvider</code></a>, create a class that implements the interface and register it using the <a href="/mongo-csharp-driver/2.1/apidocs/html/M_MongoDB_Bson_Serialization_BsonSerializer_RegisterSerializationProvider.htm
"><code>RegisterSerializationProvider</code></a> method.</p>

<pre><code class="language-csharp">class MyProvider : IBsonSerializationProvider
{
    public IBsonSerializer GetSerializer(Type type)
    {
        if (type == typeof(int))
        {
            return new MyInt32Serializer();
        }        

        return null;
    }
}
</code></pre>

<p>Above, we have a custom implemention of a serializer for an <a href="https://msdn.microsoft.com/en-us/library/system.int32.aspx"><code>Int32</code></a>. If the type being requested is for an <a href="https://msdn.microsoft.com/en-us/library/system.int32.aspx"><code>Int32</code></a>, we return our serializer. Otherwise, we return null to let the next <a href="/mongo-csharp-driver/2.1/apidocs/html/T_MongoDB_Bson_Serialization_IBsonSerializationProvider.htm
"><code>IBsonSerializationProvider</code></a> in line handle the request.</p>

<h2 id="serializers">Serializers</h2>

<p><a href="/mongo-csharp-driver/2.1/apidocs/html/T_MongoDB_Bson_Serialization_IBsonSerializer.htm
"><code>IBsonSerializer</code></a> is the main interface that is used to handle translating complex types. There are many serializers already built for handling primitive types, collection types, and <a href="/mongo-csharp-driver/2.1/reference/bson/mapping/">custom classes</a>.</p>

<p>For example, to read a file containing the JSON <code>{ a: 1, b: [{ c: 1 }] }</code> into a <a href="/mongo-csharp-driver/2.1/apidocs/html/T_MongoDB_Bson_BsonDocument.htm
"><code>BsonDocument</code></a>, use the <a href="/mongo-csharp-driver/2.1/apidocs/html/T_MongoDB_Bson_Serialization_Serializers_BsonDocumentSerializer.htm
"><code>BsonDocumentSerializer</code></a>:</p>

<pre><code class="language-csharp">var jsonString = &quot;{ a: 1, b: [{ c: 1 }] }&quot;;
using (var reader = new JsonReader(jsonString))
{
    var context = BsonDeserializationContext.CreateRoot(reader);
    BsonDocument doc = BsonDocumentSerializer.Instance.Deserialize(context);
}
</code></pre>

<h3 id="implementation-1">Implementation</h3>

<p><div class="admonition warning">
<h5 class="admonition-title">warning</h5>
Writing custom serializers to handle both normal cases and edge cases can be very tricky.
</div>
</p>

<p>To implement a custom <a href="/mongo-csharp-driver/2.1/apidocs/html/T_MongoDB_Bson_Serialization_IBsonSerializer.htm
"><code>IBsonSerializer</code></a>, it is best to inherit from <a href="/mongo-csharp-driver/2.1/apidocs/html/T_MongoDB_Bson_Serialization_Serializers_SerializerBase_1.htm
"><code>SerializerBase&lt;T&gt;</code></a> and override the <a href="/mongo-csharp-driver/2.1/apidocs/html/M_MongoDB_Bson_Serialization_Serializers_SerializerBase_1_Deserialize.htm
"><code>Deserialize</code></a> and <a href="/mongo-csharp-driver/2.1/apidocs/html/M_MongoDB_Bson_Serialization_Serializers_SerializerBase_1_Serialize.htm
"><code>Serialize</code></a> methods.</p>

<p>For example, it implement a serializer that reads an <a href="https://msdn.microsoft.com/en-us/library/system.int32.aspx"><code>Int32</code></a>:</p>

<pre><code class="language-csharp">class MyInt32Serializer : SerializerBase&lt;int&gt;
{
    public override int Deserialize(BsonDeserializationContext context, BsonDeserializationArgs args)
    {
        return context.Reader.ReadInt32();
    }

    public override void Serialize(BsonSerializationContext context, BsonSerializationArgs args, int value)
    {
        context.Writer.WriteInt32(value);
    }
}
</code></pre>

<p>This is overly simplistic. There are other factors that would need to be taken into account such as what happens when the actual BSON type is an <a href="https://msdn.microsoft.com/en-us/library/system.int64.aspx"><code>Int64</code></a>. In this case, the below implementation is much better:</p>

<pre><code class="language-csharp">class MyInt32Serializer : SerializerBase&lt;int&gt;
{
    public override int Deserialize(BsonDeserializationContext context, BsonDeserializationArgs args)
    {
        var type = context.Reader.GetCurrentBsonType();
        switch (type)
        {
            case BsonType.Int32:
                return context.Reader.ReadInt32();
            case BsonType.Int64:
                return Convert.ToInt32(context.Reader.ReadInt64());
            case BsonType.Double:
                return Convert.ToInt32(context.Reader.ReadDouble());
            case BsonType.String:
                return int.Parse(context.Reader.ReadString());
            default:
                var message = string.Format(&quot;Cannot convert a {0} to an Int32.&quot;, type);
                throw new NotSupportedException(message);
        }
    }

    public override void Serialize(BsonSerializationContext context, BsonSerializationArgs args, int value)
    {
        context.Writer.WriteInt32(value);
    }
}
</code></pre>

<p>Notice that we are testing the current BsonType while reading and making decisions. Since some of these conversions could result in an overflow or truncation, exceptions may still be thrown.</p>

<p><div class="admonition note">
<h5 class="admonition-title">Note</h5>
<p>The built-in <a href="/mongo-csharp-driver/2.1/apidocs/html/T_MongoDB_Bson_Serialization_Serializers_Int32Serializer.htm"><code>Int32Serializer</code></a> accounts for this as well as other such items.</p>

</div>
</p>

<p>You can register your serializer using the <a href="/mongo-csharp-driver/2.1/apidocs/html/M_MongoDB_Bson_Serialization_BsonSerializer_RegisterSerializer.htm
"><code>RegisterSerializer</code></a> or implement a <a href="#serialization-provider">serialization provider</a>.</p>

<h3 id="opt-in-interfaces">Opt-in Interfaces</h3>

<p>There are some opt-in interfaces that allow the driver to utilize your custom serializer in special ways. You should evaluate these interfaces and decide whether your serializer should implement them.</p>

<h4 id="ibsonidprovider">IBsonIdProvider</h4>

<p>If your class is used as a root document, you should implement the IBsonIdProvider interface in order for &ldquo;Inserting&rdquo; the document to function best, especially if the class your serializer is for uses an Id type other than <a href="/mongo-csharp-driver/2.1/apidocs/html/T_MongoDB_Bson_ObjectId.htm
"><code>ObjectId</code></a>.</p>

<h4 id="ibsondocumentserializer">IBsonDocumentSerializer</h4>

<p>In order to enable the driver to properly construct type-safe queries using a custom serializer, it needs access to member information. If your custom serializer is for a class, then you should implement <a href="/mongo-csharp-driver/2.1/apidocs/html/T_MongoDB_Bson_Serialization_IBsonDocumentSerializer.htm
"><code>IBsonDocumentSerializer</code></a>.</p>

<pre><code class="language-csharp">class MyClass
{
    public ObjectId Id { get; set; }

    public string FirstName { get; set; }

    public string LastName { get; set; }
}

class MyClassSerializer : SerializerBase&lt;MyClass&gt;, IBsonDocumentSerializer
{
    // implement Serialize and Deserialize

    public bool TryGetMemberSerializationInfo(string memberName, out BsonSerializationInfo serializationInfo)
    {
        switch (memberName)
        {
            case &quot;Id&quot;:
                serializationInfo = new BsonSerializationInfo(&quot;_id&quot;, new ObjectIdSerializer(), typeof(ObjectId));
                return true;
            case &quot;FirstName&quot;:
                serializationInfo = new BsonSerializationInfo(&quot;fn&quot;, new StringSerializer(), typeof(string));
                return true;
            case &quot;LastName&quot;:
                serializationInfo = new BsonSerializationInfo(&quot;ln&quot;, new StringSerializer(), typeof(string));
                return true;
            default:
                serializationInfo = null;
                return false;
        }
    }
}
</code></pre>

<p>Above, we are providing information about the members of our class based on the member name. This enables the driver to, for instance, translate the below lambda expression into <code>{ fn: 'Jack' }</code>.</p>

<pre><code class="language-csharp">Find(x =&gt; x.FirstName == &quot;Jack&quot;)
</code></pre>

<h4 id="ibsonarrayserializer">IBsonArraySerializer</h4>

<p>In the same way, if you have written a custom collection serializer, you should implement <a href="/mongo-csharp-driver/2.1/apidocs/html/T_MongoDB_Bson_Serialization_IBsonArraySerializer.htm
"><code>IBsonArraySerializer</code></a>.</p>






<div id="btnv">
  
  <div class="pull-left">
  <a class="navigation prev" href="/mongo-csharp-driver/2.1/reference/bson/bson_document/">
      <i class="fa fa-long-arrow-left"> </i> BsonDocument
  </a>
  </div>
  
  
  <div class="pull-right">
  <a class="navigation next" href="/mongo-csharp-driver/2.1/reference/bson/mapping/">
    Mapping Classes <i class="fa fa-long-arrow-right"> </i>
  </a>
  
</div>
</div>


</div>
<div class="right-column">
<div class="wrapper">
  
  <div class="toc">
    <span class="toc-header">On this page</span>
    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#serialization">Serialization</a></li>
<li><a href="#serializer-registry">Serializer Registry</a></li>
<li><a href="#serialization-provider">Serialization Provider</a>
<ul>
<li><a href="#implementation">Implementation</a></li>
</ul></li>
<li><a href="#serializers">Serializers</a>
<ul>
<li><a href="#implementation-1">Implementation</a></li>
<li><a href="#opt-in-interfaces">Opt-in Interfaces</a>
<ul>
<li><a href="#ibsonidprovider">IBsonIdProvider</a></li>
<li><a href="#ibsondocumentserializer">IBsonDocumentSerializer</a></li>
<li><a href="#ibsonarrayserializer">IBsonArraySerializer</a></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</nav>
  </div>
  
</div>
</div>

</div>
</div>
</div>
</section>
</section>

</section>


<script type="text/javascript">
  var DOCUMENTATION_OPTIONS = {
   URL_ROOT:    "/mongo-csharp-driver/2.1",
   VERSION:     "2.1",
   COLLAPSE_INDEX: false,
   FILE_SUFFIX: '.html',
   HAS_SOURCE:  true
  };
</script>
<script type="text/javascript" src="/mongo-csharp-driver/2.1/js/jquery.js"></script>
<script type="text/javascript" src="/mongo-csharp-driver/2.1/lib/bootstrap.js"></script>
<script type="text/javascript" src="/mongo-csharp-driver/2.1/js/navbar.js"></script>
<script type="text/javascript" src="/mongo-csharp-driver/2.1/lib/highlight/highlight.pack.js"></script>
<script type="text/javascript" src="/mongo-csharp-driver/2.1/js/scripts.js"></script>
<script type="text/javascript" src="/mongo-csharp-driver/2.1/lib/bootstrap-toggle/bootstrap-toggle.min.js"></script>
<script type="text/javascript" src="/mongo-csharp-driver/2.1/js/dn.js"></script>


<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-K75Z5Q"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push(
{'gtm.start': new Date().getTime(),event:'gtm.js'}
);var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-K75Z5Q');</script>


<script type="text/javascript">
var _elqQ = _elqQ || [];
_elqQ.push(['elqSetSiteId', '413370795']);
_elqQ.push(['elqTrackPageView']);
(function () {
function async_load()
{ var s = document.createElement('script'); s.type = 'text/javascript'; s.async = true; s.src = '//img03.en25.com/i/elqCfg.min.js'; var x = document.getElementsByTagName('script')[0]; x.parentNode.insertBefore(s, x); }
if (window.addEventListener) window.addEventListener('DOMContentLoaded', async_load, false);
else if (window.attachEvent) window.attachEvent('onload', async_load);
})();
</script>

</body>
</html>

